# カスタマーレビューシステム実験

Amazonライクなレビューシステムの実験プラットフォームです。SvelteKit 5とTailwind CSS v4を使用して構築されています。

## 概要

このプロジェクトは、次世代のレビューシステムを研究・実験するためのプラットフォームです。従来のhelpful投票に加えて、より詳細なフィードバック機能を提供し、実験参加者によるデータ収集も可能です。

### 主な機能

#### レビュー評価機能

1. **Helpful投票機能**
   - レビューの有用性を「はい」「いいえ」で投票
   - リアルタイムの投票集計とパーセンテージ表示
   - 投票の取り消し機能

2. **センテンス評価機能（改善版UI）**
   - レビューを文単位で自動分割
   - インライン表示で自然な読み取り体験
   - 文をクリックすると詳細なアノテーションパネルが表示
   - 各文に対して複数のタイプの評価（なるほど、わかりにくい、共感、役に立った）
   - 評価済み文の一覧表示

3. **テキストフィードバック機能**
   - レビューに対するスレッド式コメント
   - 返信機能による会話の展開
   - リアルタイム更新

#### 実験システム

4. **実験管理機能**
   - 3種類の実験プロトコルを実装
   - 実験順序のランダム化
   - 参加者データの自動管理
   - 実験進捗の可視化

5. **アンケート機能**
   - Likert尺度（5段階・7段階）
   - 自由記述
   - はい/いいえ形式
   - 多肢選択
   - 必須/任意の設定

6. **理解度テスト機能**
   - 商品に関する理解度を測定
   - 自動採点機能
   - 正誤の詳細表示

7. **実験データ記録**
   - すべてのユーザーアクションをログ記録
   - LocalStorageによる参加者ID管理
   - データのエクスポート機能

## 技術スタック

- **フレームワーク**: SvelteKit 2.x + Svelte 5.x (Runes mode)
- **スタイリング**: Tailwind CSS v4.x
- **UIコンポーネント**: shadcn-svelte
- **アイコン**: @lucide/svelte
- **型チェック**: TypeScript
- **ビルドツール**: Vite

## レビューデータについて

このシステムで使用しているレビューデータは、査読付き論文でよく使用される日本語レビューデータセット（楽天データセット等）を参考にしたモックデータです。

実装は以下の特徴を持ちます：
- モックデータとデータベースの容易な交換が可能
- 文単位の分割機能を内蔵
- リアルな日本語レビューのサンプル

## プロジェクト構成

```
src/
├── lib/
│   ├── mock/
│   │   ├── reviews.ts              # レビューモックデータ
│   │   └── comprehension-tests.ts  # 理解度テスト問題
│   └── experiments/
│       ├── types.ts                # 実験システムの型定義
│       ├── store.ts                # 実験データ管理ストア
│       └── experiments.ts          # 実験プロトコル定義
├── features/
│   ├── reviews/
│   │   ├── Rating.svelte           # 星評価コンポーネント
│   │   └── ReviewCard.svelte       # レビューカードコンポーネント
│   ├── experiments/
│   │   ├── ExperimentInstructions.svelte  # 実験説明
│   │   ├── QuestionnaireForm.svelte       # アンケートフォーム
│   │   ├── ComprehensionTest.svelte       # 理解度テスト
│   │   └── ExperimentProgress.svelte      # 進捗表示
│   └── users/
│       └── Avator.svelte           # ユーザーアバター
├── routes/
│   ├── +page.svelte                # ホームページ
│   ├── experiments/
│   │   ├── +page.svelte            # 実験一覧
│   │   └── [experimentId]/
│   │       └── start/              # 実験開始ページ
│   ├── products/
│   │   └── +page.svelte            # 商品一覧ページ
│   └── product/[slug]/
│       ├── +page.svelte            # 商品詳細ページ
│       ├── helpful-votes/          # Helpful投票機能
│       ├── sentence-annotations/   # センテンス評価機能（改善版）
│       └── text-feedback/          # テキストフィードバック機能
└── shared/
    └── components/ui/              # shadcn-svelteコンポーネント
```

## 実装された実験

### 実験1: テキストと選択式の比較
レビュー評価方法（自由記述 vs 選択式）の比較実験。
- ランダムな順序で両方の評価方法を体験
- 表現力、使いやすさに関するアンケート
- 所要時間: 約10〜15分

### 実験2: 数値的評価の検証
「役に立った」投票が評価を十分に反映できるかの検証実験。
- 数値的投票の実施
- 理由と不足点の記述
- 満足度評価
- 所要時間: 約5〜10分

### 実験3: 有効性の評価
レビュー評価が商品理解に与える影響の測定実験。
- 2群比較（数値的 vs 選択式）
- 理解度テスト（10問）
- UI評価アンケート
- 所要時間: 約10〜15分

## 開発

依存関係をインストールして開発サーバーを起動：

```bash
# 依存関係のインストール
bun install

# 開発サーバーの起動
bun run dev

# 開発サーバーを起動してブラウザで開く
bun run dev -- --open
```

## ビルド

本番用のビルドを作成：

```bash
bun run build
```

ビルドのプレビュー：

```bash
bun run preview
```

## リント・フォーマット

コードの品質を保つために：

```bash
# リント
bun run lint

# フォーマット
bun run format

# 型チェック
bun run check
```

## テスト

```bash
# ユニットテスト
bun run test:unit

# E2Eテスト
bun run test:e2e

# すべてのテスト
bun run test
```

## 実験データの取り扱い

実験データは以下の方法で管理されます：

- **参加者ID**: 自動生成され、LocalStorageに保存
- **実験ログ**: すべてのアクション（投票、アノテーション、フィードバック）をタイムスタンプ付きで記録
- **アンケート回答**: 質問IDと回答内容を紐付けて保存
- **理解度テスト**: 回答と正答率を記録
- **エクスポート**: データをJSON形式でエクスポート可能

## 今後の拡張予定

- [ ] 実際のデータベース連携（PostgreSQL/Supabase等）
- [ ] 実験タスクフローの完全統合
- [ ] データ分析ダッシュボード
- [ ] ユーザー認証機能
- [ ] 高度な自然言語処理による文分割の改善
- [ ] アノテーション結果の可視化・分析機能
- [ ] レビューの感情分析機能
- [ ] APIエンドポイントの実装

## ライセンス

このプロジェクトは実験・研究目的で作成されています。
